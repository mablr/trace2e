networks:
  trace2e_network:
    driver: bridge

services:
  hyper_server:
    build:
      context: ../../
      dockerfile: demo/hyper/trace2e-hyper-server.Dockerfile
    hostname: hyper_server
    container_name: hyper_server
    networks:
      - trace2e_network
    restart: unless-stopped
    entrypoint: >
      sh -c "/hypere2e_server & /hypere2e_gateway & /hyper_server & /hyper_gateway & /trace2e_middleware"


  hyper_client:
    build:
      context: ../../
      dockerfile: demo/hyper/trace2e-hyper-client.Dockerfile
    hostname: hyper_client
    container_name: hyper_client
    networks:
      - trace2e_network
    stdin_open: true
    tty: true
    depends_on:
      - hyper_server
    volumes:
      - ./scripts:/scripts
    entrypoint: >
      sh -c "/trace2e_middleware & bash"

